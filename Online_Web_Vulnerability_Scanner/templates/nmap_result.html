{% extends "layout.html" %}

{% block body %}
    <center>
    <h3 class="text-success font-monospace fw-semibold">REPORT</h3>
    <h1 class="text-primary font-monospace fw-bold">Nmap Scanner</h1>
    </center>
    
    <div class="container w-75">
        <div class="row justify-content-center text-center my-5">
            <div class="col-12 bg-success p-2 text-dark font-monospace bg-opacity-25 border border-2 rounded-4 rounded-top rounded-bottom border-success p-2 border-opacity-10 align-self-center">
				<p class="h-50 text-primary fs-5 fw-bolder">ASSET</p>
				<p class="h-50 fs-4">{{domain}}</p>
            </div>
        </div>
        
        <div class="row justify-content-center mb-2">
        	<div class="h4 pb-2 mb-4 text-primary border-bottom border-primary">
			  	<i class="bi bi-arrow-right"></i> Scan Summary
			</div>
        </div>
        
        <div class="row justify-content-center mb-5">
        	<div class="col-lg-4 col-10 bg-success p-2 text-dark font-monospace bg-opacity-25 border border-2 rounded-4 rounded-top rounded-bottom border-success border-opacity-10 m-2">
        		<p class="pt-2 text-primary fw-normal">IP</p>
				{% for ip in ips %}
					<p class="pt-2 fw-light">{{ip}}</p>
				{% endfor %}
			</div>
			<div class="col-lg-2 col-10 bg-success p-2 text-dark font-monospace bg-opacity-25 border border-2 rounded-4 rounded-top rounded-bottom border-success border-opacity-10 m-2">
			  	<p class="h-50 text-primary fw-normal">Scan Status</p>
				<p class="h-50 fw-light">Finished</p>
			</div>
			<div class="col-lg-4 col-10 bg-success p-2 text-dark font-monospace bg-opacity-25 border border-2 rounded-4 rounded-top rounded-bottom border-success border-opacity-10 m-2">
			  	<p class="h-50 text-primary fw-normal">Start Time</p>
				<p class="h-50 fw-light">{{s_time}}</p>
			</div>
			<div class="col-lg-5 col-10 bg-success p-2 text-dark font-monospace bg-opacity-25 border border-2 rounded-4 rounded-top rounded-bottom border-success border-opacity-10 m-2">
			  	<p class="h-50 text-primary fw-normal">Finish Time</p>
				<p class="h-50 fw-light">{{f_time}}</p>
			</div>
			<div class="col-lg-5 col-10 bg-success p-2 text-dark font-monospace bg-opacity-25 border border-2 rounded-4 rounded-top rounded-bottom border-success border-opacity-10 m-2">
			  	<p class="h-50 text-primary fw-normal">Scan Duration</p>
				<p class="h-50 fw-light">{{r_time[0]}} minutes, {{r_time[1]}} seconds</p>
			</div>
			<div class="col-lg-5 col-10 bg-success p-2 text-dark font-monospace bg-opacity-25 border border-2 rounded-4 rounded-top rounded-bottom border-success border-opacity-10 m-2">
			  	<p class="h-50 text-primary fw-normal">Hosts</p>
				<p class="h-50 fw-light">{{h_numbers}}</p>
			</div>
			<div class="col-lg-5 col-10 bg-success p-2 text-dark font-monospace bg-opacity-25 border border-2 rounded-4 rounded-top rounded-bottom border-success border-opacity-10 m-2">
			  	<p class="h-50 text-primary fw-normal">Open Ports</p>
				<p class="h-50 fw-light">{{p_numbers}}</p>
			</div>
        </div>
        
        <div class="row justify-content-center mb-2">
        	<div class="h4 pb-2 mb-4 text-primary border-bottom border-primary">
			  	<i class="bi bi-arrow-right"></i> Output
			</div>
        </div>
        
        <div class="row justify-content-center mb-5">
        	<div class="col-10 p-2 text-dark font-monospace m-2">
			  	<table class="table table-success table-striped bg-success bg-opacity-25 border border-2 rounded-4 rounded-top rounded-bottom border-success border-opacity-10 table-bordered">
			  		<tr>
						{% if p_type == "IP Protocol Scan" %}
							<th class="text-primary">PROTOCOL</th>
						{% else %}
							<th class="text-primary">PORT</th>
						{% endif %}
						<th class="text-primary">STATE</th>
						<th class="text-primary">SERVICE</th>
						<th class="text-primary">VERSION</th>
						<th class="text-primary">SCRIPT</th>
					</tr>
					{% for port in ports %}
						<tr>
							{% if 'port' in port %}
								<td>{{port['port']}}</td>
							{% else %}
								<td>&nbsp;</td>
							{% endif %}
							
							{% if 'state' in port %}
								<td>{{port['state']}}</td>
							{% else %}
								<td>&nbsp;</td>
							{% endif %}
							
							{% if 'service' in port %}
								<td>{{port['service']}}</td>
							{% else %}
								<td>&nbsp;</td>
							{% endif %}
							
							{% if 'version' in port %}
								<td>{{port['version']}}</td>
							{% else %}
								<td>&nbsp;</td>
							{% endif %}
							
							{% if 'script' in port %}
								<td>{{port['script']}}</td>
							{% else %}
								<td>&nbsp;</td>
							{% endif %}
						</tr>
					{% endfor %}
				</table>
			</div>
			<div class="col-10 bg-success p-2 text-dark font-monospace bg-opacity-25 border border-2 rounded-4 rounded-top rounded-bottom border-success border-opacity-10 m-2">
        		<p class="pt-2 text-primary fw-normal">OS Guesses</p>
				{% for os in oss %}
					<p class="pt-2  fw-light">{{os['os']}} ({{os['accuracy']}}%)</p>
				{% endfor %}
			</div>
        </div>
        
        <div class="row justify-content-center mb-2">
        	<div class="h4 pb-2 mb-4 text-primary border-bottom border-primary">
			  	<i class="bi bi-arrow-right"></i> Scan Parameters
			</div>
        </div>
        
        <div class="row justify-content-center mb-5">
        	<div class="col-lg-5 col-10 bg-success p-2 text-dark font-monospace bg-opacity-25 border border-2 rounded-4 rounded-top rounded-bottom border-success border-opacity-10 m-2">
        		<p class="pt-2 text-primary fw-normal">Hostname</p>
				{% for host in hosts %}
					<p class="pt-2 fw-light">{{host}}</p>
				{% endfor %}
			</div>
			<div class="col-lg-5 col-10 bg-success p-2 text-dark font-monospace bg-opacity-25 border border-2 rounded-4 rounded-top rounded-bottom border-success border-opacity-10 m-2">
			  	<p class="h-50 text-primary fw-normal">Ports</p>
				<p class="h-50 fw-light">Top 1000 ports</p>
			</div>
			<div class="col-lg-5 col-10 bg-success p-2 text-dark font-monospace bg-opacity-25 border border-2 rounded-4 rounded-top rounded-bottom border-success border-opacity-10 m-2">
			  	<p class="h-50 text-primary fw-normal">Scan Type</p>
				<p class="h-50 fw-light">{{parameter}}</p>
			</div>
			<div class="col-lg-5 col-10 bg-success p-2 text-dark font-monospace bg-opacity-25 border border-2 rounded-4 rounded-top rounded-bottom border-success border-opacity-10 m-2">
			  	<p class="h-50 text-primary fw-normal">Speed Type</p>
				<p class="h-50 fw-light">{{speed}}</p>
			</div>
        </div>
        
        <div class="row justify-content-center mb-2">
        	<div class="d-flex justify-content-center mb-4">
                <button class="btn btn-primary">Download</button>
            </div>
        	<div class="d-flex justify-content-center mb-5">
                <button class="btn btn-success">Save</button>
            </div>
        </div>
    </div>
{% endblock body %}

