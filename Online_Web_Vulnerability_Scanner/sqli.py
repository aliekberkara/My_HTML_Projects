import requests

def xss(url,dosyaAdi):
    xssDosya = open("xsspayload.txt", "r")
    xssPayload = xssDosya.readlines()
    xssDosya.close()
    esittirIndis = url.find("=")
    if "=" in url:
        for i in xssPayload:
            try:
                i = i.split("\n")[0]
                istek = str(url[:esittirIndis + 1]) + str(i)
                icerik = requests.get(istek)
                if i in icerik.content:
                    rapor=open(dosyaAdi,"w+")
                    raporIcerik="[+]XSS paylaod: "+str(i)+"\n"
                    raporIcerik+="[+]XSS URL: "+istek+"\n"
                    rapor.write(raporIcerik)
                    rapor.close()
                    return True
                else:
                    rapor=open(dosyaAdi,"w+")
                    raporIcerik="[-]XSS paylaod: "+str(i)+"\n"
                    raporIcerik+="[-]XSS URL: "+istek+"\n"
                    rapor.write(raporIcerik)
                    rapor.close()
                    return False
            except:
                pass
    else:
        rapor = open(dosyaAdi, "w+")
        raporIcerik = "[-]XSS isn't available\n"
        rapor.write(raporIcerik)
        rapor.close()
        return False

def sql(url,dosyaAdi):
    sqlDosya = open("sqlpayload.txt", "r")
    sqlPayload = sqlDosya.readlines()
    sqlDosya.close()
    if "=" in url:
        deger = str(url).find('=')
        for i in sqlPayload:
            try:
                i = i.split("\n")[0]
                yazi = str(url[0:deger + 1]) + str(i)
                sonuc = requests.get(yazi)
                if int(sonuc.status_code)==200:
                    rapor=open(dosyaAdi,"w+")
                    raporIcerik="[+]Sqli paylaod: "+str(i)+"\n"
                    raporIcerik+="[+]Sqli URL: "+yazi+"\n"
                    rapor.write(raporIcerik)
                    rapor.close()
                    
                    return True
                else:
                    rapor=open(dosyaAdi,"w+")
                    raporIcerik="[-]Sqli paylaod: "+str(i)+"\n"
                    raporIcerik+="[-]Sqli URL: "+yazi+"\n"
                    rapor.write(raporIcerik)
                    rapor.close()
                    return False
            except:
                pass
    else:
        rapor = open(dosyaAdi, "w+")
        raporIcerik = "[-]Sqli isn't available\n"
        rapor.write(raporIcerik)
        rapor.close()
        return False
